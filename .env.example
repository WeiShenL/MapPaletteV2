# MapPaletteV2 Environment Variables
# Copy this file to .env and fill in your values

# ====================
# DATABASE (Supabase PostgreSQL)
# ====================
POSTGRES_PASSWORD=your-super-secret-password-change-me
POSTGRES_DB=postgres
POSTGRES_PORT=5432
POSTGRES_HOST=supabase-db

# Prisma connection strings with connection pooling
# connection_limit: Max connections per service (10 recommended for microservices)
# pool_timeout: Time to wait for available connection (10 seconds)
# connect_timeout: Time to wait for initial connection (5 seconds)
DATABASE_URL=postgresql://postgres:your-super-secret-password-change-me@supabase-db:5432/postgres?schema=public&connection_limit=10&pool_timeout=10&connect_timeout=5
DIRECT_URL=postgresql://postgres:your-super-secret-password-change-me@supabase-db:5432/postgres?schema=public

# ====================
# SUPABASE AUTH
# ====================
# Generate JWT secret: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-secret-change-me-at-least-32-characters
JWT_EXPIRY=3600

# Generate anon key at: https://supabase.com/docs/guides/auth/jwts or use below
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImV4cCI6MTk4MzgxMjk5Nn0.EGIM96RAZx35lJzdJsyH-qQwv8Hdp7fsn3W0YpN81IU

API_EXTERNAL_URL=http://localhost:8000
SUPABASE_PUBLIC_URL=http://localhost:8000
SITE_URL=http://localhost:3000
ADDITIONAL_REDIRECT_URLS=http://localhost:3000/*

# Auth settings
DISABLE_SIGNUP=false
ENABLE_EMAIL_SIGNUP=true
ENABLE_EMAIL_AUTOCONFIRM=true
ENABLE_ANONYMOUS_USERS=false
ENABLE_PHONE_SIGNUP=false
ENABLE_PHONE_AUTOCONFIRM=false

# PostgREST
PGRST_DB_SCHEMAS=public,storage,graphql_public

# Image Proxy
IMGPROXY_ENABLE_WEBP_DETECTION=true

# ====================
# REDIS
# ====================
REDIS_URL=redis://redis:6379
REDIS_PORT=6379

# ====================
# INTERNAL SERVICE AUTHENTICATION
# ====================
# Generate with: openssl rand -hex 32
INTERNAL_SERVICE_KEY=change-me-to-a-random-string-use-openssl-rand-hex-32

# ====================
# SERVICE PORTS
# ====================
USER_SERVICE_PORT=3001
POST_SERVICE_PORT=3002
INTERACTION_SERVICE_PORT=3003
FEED_SERVICE_PORT=3004
SOCIAL_INTERACTION_SERVICE_PORT=3005
PROFILE_SERVICE_PORT=3006
FOLLOW_SERVICE_PORT=3007
EXPLORE_ROUTES_SERVICE_PORT=3008
LEADERBOARD_SERVICE_PORT=8080
USER_DISCOVERY_SERVICE_PORT=3010

# Kong Gateway
KONG_HTTP_PORT=8000
KONG_HTTPS_PORT=8443

# Supabase Storage
STORAGE_PORT=5000

# Frontend
FRONTEND_PORT=3000
VITE_API_URL=http://localhost:8080
VITE_SUPABASE_URL=http://localhost:8000
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0

# ====================
# GOOGLE MAPS API
# ====================
# Required for map image generation (Static Maps API)
# Get your API key: https://console.cloud.google.com/google/maps-apis/credentials
GOOGLE_MAPS_API_KEY=your-google-maps-api-key-here

# ====================
# PRODUCTION SETTINGS
# ====================
NODE_ENV=production

# Domain (for production with Caddy)
DOMAIN=mappalette.com

# SMTP (for email confirmations in production)
SMTP_ADMIN_EMAIL=admin@mappalette.com
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_SENDER_NAME=MapPalette

# Mailer URL paths
MAILER_URLPATHS_INVITE=/auth/confirm
MAILER_URLPATHS_CONFIRMATION=/auth/confirm
MAILER_URLPATHS_RECOVERY=/auth/reset-password
MAILER_URLPATHS_EMAIL_CHANGE=/auth/confirm

# ====================
# OPTIONAL: External Services
# ====================
# Use these if NOT using local Supabase
# SUPABASE_URL=https://your-project.supabase.co
# SUPABASE_ANON_KEY=your-anon-key-from-supabase-dashboard
# DATABASE_URL=your-supabase-connection-string

# Use this if using Upstash Redis instead of local
# UPSTASH_REDIS_URL=your-upstash-redis-url
